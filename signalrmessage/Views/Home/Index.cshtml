@{
	Layout = null;
}

<!--Script references. -->
<!--Reference the jQuery library. -->
<script src="../Scripts/jquery-1.10.2.min.js"></script>
<!--Reference the SignalR library. -->
<script src="../Scripts/jquery.signalR-2.2.3.min.js"></script>
<!--Reference the autogenerated SignalR hub script. -->
<script src="~/signalr/hubs"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>

<div class="container" ng-controller="myCtrl">
	<div class="row" style="margin-top:50px;">
		<div class="col-md-6">
			<div class="row" style="margin-bottom:20px;">
				<div class="col-md-12">
					<h2>Your Message</h2>
				</div>
			</div>
			<div class="row">
				<div class="col-md-12">
					<input class="btn" type="text" style="background-color: #eee; border-radius:0px; text-align:left;" id="username" placeholder="Name" />
					<input class="btn" type="text" style="background-color: #eee; border-radius:0px; text-align:left;" id="message" placeholder="Enter your message..." />
					<input type="button" style="border-radius:0px;" class="btn btn-primary" value="Send"  id="sendmessage"/>
				</div>
			</div>
		</div>
		<div class="col-md-6">
			<div class="row" style="margin-bottom:20px;">
				<div class="col-md-12">
					<h2>Conversation</h2>
				</div>
			</div>
			<div class="row">
				<ul style="list-style:none; padding:0px 15px" id="discussion"></ul>
			</div>
		</div>
	</div>
</div>

<script>
	$(function () {
		// Declare a proxy to reference the hub.
		var chat = $.connection.messageHub;
		// Create a function that the hub can call to broadcast messages.
		chat.client.broadcastMessage = function (name, message) {
			// Html encode display name and message.
			var encodedName = $('<div />').text(name).html();
			var encodedMsg = $('<div />').text(message).html();
			// Add message to conversation
			$('#discussion').append('<li style="margin-top:10px;">'
				+ "<b>" + encodedName + "</b>"
				+ ':&nbsp;&nbsp;&nbsp;'
				+ encodedMsg
				+ '</li>');
		};
		// Start the connection.
		$.connection.hub.start().done(function () {
			function sendMessage() {
				// Call the Send method on the hub.
				if ($('#message').val().length > 0) {
					chat.server.sendMessage($('#username').val(), $('#message').val());
					$('#message').val('').focus();
				}
			}
			$(document).keypress(function (e) {
				if (e.which == 13) {
					sendMessage();
				}
			});
			$('#sendmessage').click(sendMessage);
		});
	});
</script>